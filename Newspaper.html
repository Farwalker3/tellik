<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Directory</title>
    <link rel="stylesheet" type="text/css" href="Newspaper.css">
    <link rel="icon" type="image/svg" href="tellik.svg">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
</head>
<body>
    <div class="dashboard">
        
        <div class="profile">
            <h2>Tellik Directory</h2>
            <p>See the storytellers that are members and that we have our eye on</p>
        </div>
        
        <div class="schedule-table">
            <h2>Member Directory</h2>
            <div class="table-wrap">
                <table>
                    <thead>
                        <tr>
                            <th>Storyteller</th>
                            <th>Story</th>
                            <th>Medium</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Rows will be populated here by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="exercise-table">
            <h2>Wishlist</h2>
            <div class="table-wrap">
                <table>
                    <thead>
                        <tr>
                            <th>Storyteller</th>
                            <th>Story</th>
                            <th>Medium</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Rows will be populated here by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
        
    </div>

    <!-- JavaScript Code -->
    <script>
        // Fetch CSV data using PapaParse
        async function fetchCSVData() {
            try {
                const response = await fetch('https://res.cloudinary.com/kodair/raw/upload/Tellik/directory.csv');
                if (!response.ok) {
                    throw new Error('Failed to fetch data');
                }
                const csvData = await response.text();
                const jsonData = Papa.parse(csvData, { header: true }).data;
                return jsonData;
            } catch (error) {
                console.error(error);
                return [];
            }
        }
        
        async function populateTables() {
            const data = await fetchCSVData();
            
            // Filter the data for different sections
            const memberData = data.filter(item => item.Table === 'Member Directory');
            const wishlistData = data.filter(item => item.Table === 'Wishlist');
            
            // Populate Member Directory Table
            const memberTableBody = document.querySelector('.schedule-table .table-wrap table tbody');
            memberData.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `<td>${item.Storyteller}</td><td>${item.Story}</td><td>${item.Medium}</td>`;
                memberTableBody.appendChild(row);
            });
            
            // Populate Wishlist Table
            const wishlistTableBody = document.querySelector('.exercise-table .table-wrap table tbody');
            wishlistData.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `<td>${item.Storyteller}</td><td>${item.Story}</td><td>${item.Medium}</td>`;
                wishlistTableBody.appendChild(row);
            });
        }
        
        // Run populateTables after DOM has loaded
        document.addEventListener('DOMContentLoaded', populateTables);
    </script>
</body>
</html>